(function(t){function e(e){for(var s,r,l=e[0],o=e[1],c=e[2],d=0,p=[];d<l.length;d++)r=l[d],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&p.push(i[r][0]),i[r]=0;for(s in o)Object.prototype.hasOwnProperty.call(o,s)&&(t[s]=o[s]);u&&u(e);while(p.length)p.shift()();return n.push.apply(n,c||[]),a()}function a(){for(var t,e=0;e<n.length;e++){for(var a=n[e],s=!0,l=1;l<a.length;l++){var o=a[l];0!==i[o]&&(s=!1)}s&&(n.splice(e--,1),t=r(r.s=a[0]))}return t}var s={},i={app:0},n=[];function r(e){if(s[e])return s[e].exports;var a=s[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=s,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)r.d(a,s,function(e){return t[e]}.bind(null,s));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],o=l.push.bind(l);l.push=e,l=l.slice();for(var c=0;c<l.length;c++)e(l[c]);var u=o;n.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"0119":function(t,e,a){},"017c":function(t,e,a){"use strict";a("7965")},"056f":function(t,e,a){},"07f8":function(t,e,a){"use strict";a("8d14")},"0889":function(t,e,a){"use strict";a("3b34")},"0d3c":function(t,e,a){"use strict";a("5f3a")},"0ef0":function(t,e,a){"use strict";a("0119")},2820:function(t,e,a){"use strict";a("f53a")},"2c89":function(t,e,a){},3991:function(t,e,a){},"3b34":function(t,e,a){},"3c06":function(t,e,a){"use strict";a("056f")},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var s=a("2b0e"),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},n=[],r={name:"App"},l=r,o=a("2877"),c=Object(o["a"])(l,i,n,!1,null,null,null),u=c.exports,d=a("8c4f"),p=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"login-container"},[a("div",{staticClass:"login-warp"},[a("el-form",{ref:"login-form",staticClass:"login-form",attrs:{model:t.user,rules:t.formRoules,"label-width":"0px"}},[a("div",{staticClass:"login-text"},[t._v("欢迎登录")]),a("el-form-item",{attrs:{prop:"mobile"}},[a("el-input",{attrs:{placeholder:"手机号"},model:{value:t.user.mobile,callback:function(e){t.$set(t.user,"mobile",e)},expression:"user.mobile"}})],1),a("el-form-item",{attrs:{prop:"code"}},[a("el-input",{attrs:{placeholder:"验证码"},model:{value:t.user.code,callback:function(e){t.$set(t.user,"code",e)},expression:"user.code"}})],1),a("div",{staticClass:"user-notice"},[t._v("手机验证后自动登录，登录即代表同意《拓扑头条用户协议》和《隐私保护指引》")]),a("el-form-item",[a("el-button",{staticClass:"login-btn",attrs:{type:"primary",loading:t.loginLoading},on:{click:t.onLogin,keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onLogin.apply(null,arguments)}}},[t._v("登录")])],1)],1)],1)])},m=[],f=a("1da1"),v=(a("e9c4"),a("b0c0"),a("96cf"),a("d3b7"),a("bc3a")),g=a.n(v),h=a("d604"),b=a.n(h),C=a("5c96"),w=a.n(C),_=g.a.create({baseURL:"http://api-toutiao-web.itheima.net/",transformResponse:[function(t){try{return b.a.parse(t)}catch(e){return t}}]});_.interceptors.request.use((function(t){var e=JSON.parse(window.localStorage.getItem("user"));return e&&(t.headers.Authorization="Bearer ".concat(e.token)),t}),(function(t){return Promise.reject(t)})),_.interceptors.response.use((function(t){return t}),(function(t){var e=t.response.status;return t.response&&401===e?(window.localStorage.removeItem("user"),je.push("/login"),C["Message"].error("登录状态无效，请重新登录")):t.response&&400===e?C["Message"].error("请求参数错误"):t.response&&403===e?C["Message"].warning("无操作权限"):t.response&&e>=500&&C["Message"].error("服务端内部错误"),Promise.reject(t)}));var y=_,x=function(t){return y({method:"POST",url:"/mp/v1_0/authorizations",data:t})},k=function(){return y({method:"GET",url:"/mp/v1_0/user/profile"})},$=function(t){return y({method:"PATCH",url:"/mp/v1_0/user/profile",data:t})},U=function(t){return y({method:"PATCH",url:"/mp/v1_0/user/photo",data:t})},S={name:"LoginIndex",data:function(){return{user:{mobile:"13911111111",code:"246810"},loginLoading:!1,formRoules:{mobile:[{required:!0,message:"手机号不能为空",trigger:"blur"},{pattern:/^1[3|5|7|8|9]\d{9}$/,message:"请输入正确的手机号码",trigger:"blur"}],code:[{required:!0,message:"验证码不能为空",trigger:"blur"},{pattern:/^\d{6}$/,message:"请输入正确格式的验证码",trigger:"blur"}]}}},mounted:function(){this.$notify({title:"提示",dangerouslyUseHTMLString:!0,message:"<div>默认手机号：13911111111</div><div>默认验证码：246810</div>"})},methods:{onLogin:function(){var t=this;return Object(f["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$refs["login-form"].validate((function(e){if(!e)return!1;t.login()}));case 1:case"end":return e.stop()}}),e)})))()},login:function(){var t=this;x(this.user).then((function(e){window.localStorage.setItem("user",JSON.stringify(e.data.data)),t.$router.push({name:"home"}),t.$notify({title:e.data.data.name,message:"欢迎回来！"})})).catch((function(){t.$notify({title:"错误",message:"登录失败，手机号或验证码错误",type:"error"})}))}}},z=S,L=(a("afb6"),Object(o["a"])(z,p,m,!1,null,"29efcbcf",null)),A=L.exports,O=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"home-container"},[a("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[a("div",{staticClass:"notice-warp"},[a("span",{staticClass:"card-title-warp"},[a("i",{staticClass:"el-icon-bell"}),t._v("关于更新用户使用协议的通知")]),a("span",{staticClass:"notice-time"},[t._v("2021-11-25")])])]),a("el-card",{staticClass:"box-card count-data-card",attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("账号情况")])]),a("div",{staticClass:"count-data"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{xs:24,sm:8,md:6,lg:6,xl:6}},[a("div",{staticClass:"grid-content bg-purple"},[a("div",{staticClass:"data-item"},[a("div",{staticClass:"data-name"},[a("i",{staticClass:"el-icon-files"}),t._v("新增粉丝")]),a("div",{staticClass:"data-num"},[t._v("0")])])])]),a("el-col",{attrs:{xs:24,sm:8,md:6,lg:6,xl:6}},[a("div",{staticClass:"grid-content bg-purple"},[a("div",{staticClass:"data-item"},[a("div",{staticClass:"data-name"},[a("i",{staticClass:"el-icon-user"}),t._v("总粉丝数")]),a("div",{staticClass:"data-num"},[t._v(t._s(t.totalFans))])])])]),a("el-col",{attrs:{xs:24,sm:8,md:6,lg:6,xl:6}},[a("div",{staticClass:"grid-content bg-purple"},[a("div",{staticClass:"data-item"},[a("div",{staticClass:"data-name"},[a("i",{staticClass:"el-icon-tickets"}),t._v("昨日发布")]),a("div",{staticClass:"data-num"},[t._v("0")])])])]),a("el-col",{attrs:{xs:24,sm:8,md:6,lg:6,xl:6}},[a("div",{staticClass:"grid-content bg-purple"},[a("div",{staticClass:"data-item"},[a("div",{staticClass:"data-name"},[a("i",{staticClass:"el-icon-office-building"}),t._v("总发布数")]),a("div",{staticClass:"data-num"},[t._v(t._s(t.totalCount))])])])])],1)],1)]),a("el-card",{staticClass:"box-card write-article-card",attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("新的创作")])]),a("div",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{xs:12,sm:8,md:6,lg:4,xl:3}},[a("div",{staticClass:"text-article",on:{click:function(e){return t.$router.push("/publish")}}},[a("i",{staticClass:"el-icon-tickets"}),t._v("图文消息")])])],1)],1)]),a("el-card",{staticClass:"box-card recent-card",attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix rescent-warp",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("最近发布")]),a("span",{staticClass:"more-btn",on:{click:function(e){return t.$router.push("/article")}}},[t._v("全部"),a("i",{staticClass:"el-icon-arrow-right"})])]),a("div",[a("div",{staticClass:"recent-article-item"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.articles,"show-header":!1}},[a("el-table-column",{attrs:{prop:"pubdate",width:"170"}}),a("el-table-column",{attrs:{width:"130"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"article-cover"},[e.row.cover.images[0]?a("el-image",{attrs:{src:e.row.cover.images[0],fit:"cover",lazy:""}},[a("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[t._v("加载中"),a("span",{staticClass:"dot"},[t._v("...")])])]):a("el-image",{attrs:{src:"",fit:"cover",lazy:""}},[a("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[t._v("无封面")])])],1)]}}])}),a("el-table-column",{attrs:{prop:"title"}}),a("el-table-column",{staticClass:"tools-warp",attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑",placement:"top-start"}},[a("el-button",{staticClass:"article-tools",attrs:{type:"primary",plain:"",size:"mini",icon:"el-icon-edit",circle:""},on:{click:function(a){return t.$router.push("/publish?id="+e.row.id)}}})],1)]}}])})],1)],1)])])],1)},E=[],I=function(t){return y({method:"GET",url:"/mp/v1_0/articles",params:t})},P=function(){return y({method:"GET",url:"/mp/v1_0/channels"})},D=function(t){return y({method:"DELETE",url:"/mp/v1_0/articles/".concat(t)})},T=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return y({method:"POST",url:"/mp/v1_0/articles",params:{draft:e},data:t})},F=function(t){return y({method:"GET",url:"/mp/v1_0/articles/".concat(t)})},j=function(t,e){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return y({method:"PUT",url:"/mp/v1_0/articles/".concat(t),params:{draft:a},data:e})},V=function(t,e){return y({method:"PUT",url:"/mp/v1_0/comments/status",params:{article_id:t},data:{allow_comment:e}})},N=function(t){return y({method:"GET",url:"/mp/v1_0/followers",data:t})},R={name:"HomeIndex",data:function(){return{loading:!1,articles:[],totalCount:0,totalFans:0}},created:function(){this.loadArticles(),this.loadFansNum()},methods:{loadArticles:function(){var t=this;this.loading=!0,I({}).then((function(e){t.loading=!1;var a=e.data.data,s=a.results,i=a.total_count;t.articles=s,t.totalCount=i}))},loadFansNum:function(){var t=this;N().then((function(e){var a=e.data.data.total_count;t.totalFans=a}))}}},q=R,M=(a("3c06"),Object(o["a"])(q,O,E,!1,null,"52a9daf6",null)),B=M.exports,H=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-container",{staticClass:"layout-warp"},[s("el-header",{staticClass:"header-warp"},[s("div",{staticClass:"logo-header-warp"},[s("img",{staticClass:"logo-header",attrs:{src:a("cf05"),alt:""}}),s("span",{staticClass:"logo-header-text"},[t._v("黑马头条 | 创作中心")])]),s("el-dropdown",[s("div",{staticClass:"user-warp"},[s("img",{staticClass:"user-avator",attrs:{src:t.user.photo?t.user.photo:"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png",alt:""}})]),s("el-dropdown-menu",{staticClass:"user-dropdown",attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item",[t._v("您好，"+t._s(t.user.name))]),s("el-dropdown-item",{nativeOn:{click:function(e){return t.$router.push("/settings")}}},[s("i",{staticClass:"iconfont icon-shezhi1"}),t._v("设置 ")]),s("el-dropdown-item",{nativeOn:{click:function(e){return t.onLogOut.apply(null,arguments)}}},[s("i",{staticClass:"iconfont icon-tuichu"}),t._v("退出")])],1)],1)],1),s("el-container",{staticClass:"down-warp"},[s("el-aside",{staticClass:"aside-warp",attrs:{width:"auto"}},[s("app-aside",{attrs:{"is-collapse":t.isCollapse}}),s("el-tooltip",{attrs:{effect:"dark",content:t.isCollapse?"展开":"折叠",placement:"right"}},[s("div",{staticClass:"collapse-btn",on:{click:function(e){t.isCollapse=!t.isCollapse}}},[s("i",{class:t.isCollapse?"iconfont el-icon-s-unfold":"iconfont el-icon-s-fold"})])])],1),s("el-main",{staticClass:"main-warp"},[s("router-view")],1)],1)],1)},G=[],J=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-menu",{staticClass:"aside-menu",attrs:{"default-active":t.$route.path,"background-color":"transparent",collapse:t.isCollapse,"active-text-color":"var(--themeColor)",router:"","collapse-transition":!0}},[a("el-menu-item",{attrs:{index:"/"}},[a("i",{staticClass:"iconfont icon-iconfontzhizuobiaozhun023101"}),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("首页")])]),a("el-menu-item",{attrs:{index:"/article"}},[a("i",{staticClass:"iconfont icon-neirongguanli"}),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("内容")])]),a("el-menu-item",{attrs:{index:"/image"}},[a("i",{staticClass:"iconfont icon-tupian"}),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("素材")])]),a("el-menu-item",{attrs:{index:"/publish"}},[a("i",{staticClass:"iconfont icon-fabu2"}),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("发布")])]),a("el-menu-item",{attrs:{index:"/comment"}},[a("i",{staticClass:"iconfont icon-pinglun"}),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("评论管理")])]),a("el-menu-item",{attrs:{index:"/fans"}},[a("i",{staticClass:"iconfont icon-ziyuan191"}),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("粉丝管理")])]),a("el-menu-item",{attrs:{index:"/settings"}},[a("i",{staticClass:"iconfont icon-shezhi1"}),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("个人中心")])])],1)},W=[],K={name:"AppAside",props:["is-collapse"],methods:{handleOpen:function(t,e){console.log(t,e)},handleClose:function(t,e){console.log(t,e)}}},Q=K,X=(a("afaa"),Object(o["a"])(Q,J,W,!1,null,"383a8489",null)),Y=X.exports,Z=new s["default"],tt={name:"LayoutIndex",data:function(){return{user:{},isCollapse:!1}},components:{AppAside:Y},created:function(){var t=this;this.loadUserProfile(),Z.$on("update-user",(function(e){t.user.name=e.name,t.user.photo=e.photo}))},methods:{loadUserProfile:function(){var t=this;k().then((function(e){t.user=e.data.data}))},onLogOut:function(){var t=this;this.$confirm("确认要退出吗？","退出登录",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){window.localStorage.removeItem("user"),t.$router.push("/login")}))}}},et=tt,at=(a("0889"),Object(o["a"])(et,H,G,!1,null,"3ba37c3a",null)),st=at.exports,it=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"article-container"},[a("el-card",{staticClass:"filter-warp",attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[t._v("首页")]),a("el-breadcrumb-item",[t._v("内容")])],1)],1)]),a("div",[a("el-form",{ref:"form",attrs:{model:t.form,"label-width":"50px",size:"small"}},[a("el-form-item",{attrs:{label:"状态"}},[a("el-radio-group",{model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},[a("el-radio",{attrs:{label:null}},[t._v("全部")]),a("el-radio",{attrs:{label:0}},[t._v("草稿")]),a("el-radio",{attrs:{label:1}},[t._v("待审核")]),a("el-radio",{attrs:{label:2}},[t._v("审核通过")]),a("el-radio",{attrs:{label:3}},[t._v("审核失败")]),a("el-radio",{attrs:{label:4}},[t._v("已删除")])],1)],1),a("el-form-item",{attrs:{label:"分类"}},[a("el-select",{attrs:{placeholder:"请选择文章分类"},model:{value:t.channelId,callback:function(e){t.channelId=e},expression:"channelId"}},[a("el-option",{attrs:{label:"全部",value:null}}),t._l(t.channels,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],2)],1),a("el-form-item",{attrs:{label:"范围"}},[a("el-date-picker",{attrs:{type:"daterange",align:"center","unlink-panels":"","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":t.form.pickerOptions,"value-format":"yyyy-MM-dd"},model:{value:t.rangeDate,callback:function(e){t.rangeDate=e},expression:"rangeDate"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:function(e){return t.loadArticles(1)}}},[t._v("查询")])],1)],1)],1)]),a("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"list-table",staticStyle:{width:"100%"},attrs:{data:t.articles}},[a("el-table-column",{attrs:{label:"封面"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"article-cover"},[e.row.cover.images[0]?a("el-image",{attrs:{src:e.row.cover.images[0],fit:"cover",lazy:""}},[a("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[t._v("加载中"),a("span",{staticClass:"dot"},[t._v("...")])])]):a("el-image",{attrs:{src:"",fit:"cover",lazy:""}},[a("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[t._v("无封面")])])],1)]}}])}),a("el-table-column",{attrs:{prop:"title",label:"标题"}}),a("el-table-column",{attrs:{label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{size:"medium",type:t.articleStatus[e.row.status].type}},[t._v(t._s(t.articleStatus[e.row.status].text))])]}}])}),a("el-table-column",{attrs:{label:"发布时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("i",{staticClass:"el-icon-time"}),a("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(e.row.pubdate))])]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑",placement:"top-start"}},[a("el-button",{attrs:{type:"primary",plain:"",size:"mini",icon:"el-icon-edit",circle:""},on:{click:function(a){return t.$router.push("/publish?id="+e.row.id)}}})],1),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top-start"}},[a("el-button",{attrs:{type:"danger",plain:"",size:"mini",icon:"el-icon-delete",circle:""},on:{click:function(a){return t.onDeleteArticle(e.row.id)}}})],1)]}}])})],1),a("el-pagination",{staticClass:"list-pagination",attrs:{background:"","current-page":t.currentPage,"page-sizes":[10,20,30],"page-size":t.pageSize,layout:"total,prev, pager, next",total:t.totalCount,"hide-on-single-page":!0,disabled:t.loading},on:{"current-change":t.onCurrentChange}})],1)])],1)},nt=[],rt=(a("25f0"),{name:"ArticleIndex",data:function(){return{form:{pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-2592e6),t.$emit("pick",[a,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-7776e6),t.$emit("pick",[a,e])}}]}},articles:[],articleStatus:[{status:0,text:"草稿",type:"info"},{status:1,text:"待审核",type:"warning"},{status:2,text:"审核通过",type:"success"},{status:3,text:"审核失败",type:"danger"},{status:4,text:"已删除",type:"danger"}],currentPage:1,totalCount:0,pageSize:10,status:null,channels:[],channelId:null,rangeDate:null,loading:!0}},created:function(){this.loadChannels(),this.loadArticles()},methods:{loadArticles:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.loading=!0,I({page:e,per_page:this.pageSize,status:this.status,channel_id:this.channelId,begin_pubdate:this.rangeDate?this.rangeDate[0]:null,end_pubdate:this.rangeDate?this.rangeDate[1]:null}).then((function(e){t.loading=!1;var a=e.data.data,s=a.results,i=a.total_count;t.articles=s,t.totalCount=i}))},onCurrentChange:function(t){this.currentPage=t,this.loadArticles(t)},loadChannels:function(){var t=this;P().then((function(e){t.channels=e.data.data.channels}))},onDeleteArticle:function(t){var e=this;this.$confirm("确认要删除吗？","删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){D(t.toString()).then((function(t){e.$notify({title:"成功",message:"删除文章成功",type:"success"}),e.loadArticles(e.currentPage)}))}))}}}),lt=rt,ot=(a("a3f4"),Object(o["a"])(lt,it,nt,!1,null,"8985ce9e",null)),ct=ot.exports,ut=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"publish-container"},[a("div",{staticClass:"article-pub-card"},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[t._v("首页")]),a("el-breadcrumb-item",[t._v(t._s(t.$route.query.id?"修改文章":"发布文章"))])],1)],1),a("div",[a("el-form",{ref:"publish-from",attrs:{rules:t.articleRules,model:t.article,"label-width":"80px",size:"small"}},[a("el-form-item",{attrs:{label:"文章标题",prop:"title"}},[a("el-input",{attrs:{placeholder:"请输入文章标题",maxlength:"30","show-word-limit":""},model:{value:t.article.title,callback:function(e){t.$set(t.article,"title",e)},expression:"article.title"}})],1),a("el-form-item",{attrs:{label:"正文",prop:"content"}},[a("el-tiptap",{staticClass:"tiptap-warp",attrs:{charCounterCount:!1,extensions:t.extensions,lang:"zh",placeholder:"请输入文章内容"},model:{value:t.article.content,callback:function(e){t.$set(t.article,"content",e)},expression:"article.content"}})],1),a("el-form-item",{attrs:{label:"分类专栏",prop:"channel_id"}},[a("el-select",{attrs:{placeholder:"请选择分类专栏"},model:{value:t.article.channel_id,callback:function(e){t.$set(t.article,"channel_id",e)},expression:"article.channel_id"}},t._l(t.channels,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),a("el-form-item",{attrs:{label:"展示封面"}},[a("el-radio-group",{model:{value:t.article.cover.type,callback:function(e){t.$set(t.article.cover,"type",e)},expression:"article.cover.type"}},[a("el-radio",{attrs:{label:1}},[t._v("单图")]),a("el-radio",{attrs:{label:3}},[t._v("三图")]),a("el-radio",{attrs:{label:0}},[t._v("无封面")]),a("el-radio",{attrs:{label:-1}},[t._v("自动")])],1),t.article.cover.type>0?a("div",{staticClass:"upload-cover-warp"},t._l(t.article.cover.type,(function(e,s){return a("upload-cover",{key:e,model:{value:t.article.cover.images[s],callback:function(e){t.$set(t.article.cover.images,s,e)},expression:"article.cover.images[index]"}})})),1):t._e()],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.onPublish(!1)}}},[t._v(t._s(t.$route.query.id?"确认修改":"立即发布"))]),a("el-button",{on:{click:function(e){return t.onPublish(!0)}}},[t._v("保存为草稿")])],1)],1)],1)])],1),a("div",{staticClass:"article-show-card"},[a("div",{staticClass:"article-show"},[t._v("文章预览")]),a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"article-title"},[t._v(" "+t._s(t.article.title||"请输入文章标题")+" "),a("div",{staticClass:"article-author"},[a("div",{staticClass:"author-cover"},[a("img",{staticClass:"author-cover-img",attrs:{src:t.user.photo?t.user.photo:"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png",alt:""}}),a("span",{staticClass:"author-name"},[t._v(t._s(t.user.name))])])])]),a("div",{staticClass:"article-content"},[a("div",{staticClass:"ql-editor markdown-body",domProps:{innerHTML:t._s(t.article.content||"请输入文章内容")}})])]),a("div",{staticClass:"article-case"},[0===t.article.cover.type?a("div",{staticClass:"case-warp case-none"},[t._v(t._s(t.article.title||"标题"))]):t._e(),-1===t.article.cover.type?a("div",{staticClass:"case-warp case-one"},[a("div",{staticClass:"text-warp"},[t._v(t._s(t.article.title||"标题"))]),a("div",{staticClass:"img-warp"},[a("img",{attrs:{src:t.article.cover.images[0]}})])]):t._e(),1===t.article.cover.type?a("div",{staticClass:"case-warp case-one"},[a("div",{staticClass:"text-warp"},[t._v(t._s(t.article.title||"标题"))]),a("div",{staticClass:"img-warp"},[a("img",{attrs:{src:t.article.cover.images[0]}})])]):t._e(),3===t.article.cover.type?a("div",{staticClass:"case-warp case-three"},[a("div",{staticClass:"text-warp"},[t._v(t._s(t.article.title||"标题"))]),a("div",{staticClass:"img-warp"},[a("div",{staticClass:"img-content"},[a("img",{attrs:{src:t.article.cover.images[0]}})]),a("div",{staticClass:"img-content"},[a("img",{attrs:{src:t.article.cover.images[1]}})]),a("div",{staticClass:"img-content"},[a("img",{attrs:{src:t.article.cover.images[2]}})])])]):t._e()])],1)])},dt=[],pt=function(t){return y({method:"POST",url:"/mp/v1_0/user/images",data:t})},mt=function(t){return y({method:"GET",url:"/mp/v1_0/user/images",params:t})},ft=function(t,e){return y({method:"PUT",url:"/mp/v1_0/user/images/".concat(t),data:{collect:e}})},vt=function(t){return y({method:"DELETE",url:"/mp/v1_0/user/images/".concat(t)})},gt=a("4ccc"),ht=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"upload-cover-container"},[a("div",{staticClass:"cover-warp",on:{click:t.showCoverSelect}},[a("img",{ref:"cover-image",staticClass:"cover-image",attrs:{src:t.value,alt:""}}),t._v(t._s(t.value?"":"+"))]),a("el-dialog",{attrs:{title:"选择封面",visible:t.coverSelectDialog,width:"50%","append-to-body":!0},on:{"update:visible":function(e){t.coverSelectDialog=e},closed:t.resetUploadImage}},[a("span",[a("el-tabs",{attrs:{type:"card"},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"素材库",name:"first"}},[a("image-list",{ref:"image-list",attrs:{"is-show-add":!1,"is-show-action":!1}})],1),a("el-tab-pane",{attrs:{label:"上传图片",name:"second"}},[a("div",{staticClass:"upload-img-warp"},[a("div",{staticClass:"upload-btns"},[a("input",{ref:"upload-cover",attrs:{type:"file",name:"",hidden:""},on:{change:t.onFileChange}}),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.$refs["upload-cover"].click()}}},[t._v("上传文件")])],1),a("div",{staticClass:"preview-cover-warp"},[t.previewImage?a("img",{staticClass:"preview-cover",attrs:{src:t.previewImage,alt:""}}):a("div",[t._v("请选择文件")])])])])],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(e){t.coverSelectDialog=!1}}},[t._v("取 消")]),a("el-button",{attrs:{size:"small",type:"primary",loading:t.updateCoverLoading},on:{click:t.onUploadCover}},[t._v("确 定")])],1)])],1)},bt=[],Ct=(a("3ca3"),a("ddb0"),a("2b3d"),a("9861"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"image-list-container"},[a("div",{staticClass:"tool-warp"},[a("el-radio-group",{attrs:{size:"small"},on:{change:function(e){return t.loadImages(1)}},model:{value:t.collect,callback:function(e){t.collect=e},expression:"collect"}},[a("el-radio-button",{attrs:{label:!1}},[t._v("全部("+t._s(t.totalAll)+")")]),a("el-radio-button",{attrs:{label:!0}},[t._v("我的收藏")])],1),t.isShowAdd?a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){t.dialogTableVisible=!0}}},[t._v("上传")]):t._e()],1),a("el-row",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{gutter:20}},t._l(t.images,(function(e,s){return a("el-col",{key:e.id,attrs:{xs:12,sm:8,md:6,lg:4,xl:4}},[a("div",{class:t.selected===s?"image-warp image-warp-active":"image-warp",on:{click:function(e){t.selected=s}}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-image",{attrs:{src:e.url}})],1),t.isShowAction?a("div",{staticClass:"tools-warp"},[a("el-button",{attrs:{icon:e.is_collected?"iconfont icon-shoucang1":"iconfont icon-shoucang",circle:"",size:"mini",loading:e.loading},on:{click:function(a){return t.onCollect(e)}}}),a("el-button",{attrs:{icon:"iconfont icon-shanchu",circle:"",size:"mini",loading:e.loading},on:{click:function(a){return t.onDelete(e)}}})],1):t._e()])])})),1),a("el-pagination",{staticClass:"list-pagination",attrs:{background:"",layout:"prev, pager, next",total:t.totalCount,"hide-on-single-page":!0,"page-size":t.pageSize,disabled:t.loading,"current-page":t.page},on:{"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e},"current-change":t.onPageChange}}),a("el-dialog",{attrs:{title:"上传素材",visible:t.dialogTableVisible,"append-to-body":!0,width:"40%"},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[t.dialogTableVisible?a("el-upload",{staticClass:"upload-warp",attrs:{drag:"",action:"http://ttapi.research.itcast.cn/mp/v1_0/user/images",headers:t.uploadHeaders,name:"image",multiple:"","on-success":t.onUploadImgSuccess,"on-error":t.onUploadImgErr}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),a("em",[t._v("点击上传")])]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg/png文件，且不超过500kb")])]):t._e()],1)],1)}),wt=[],_t=(a("159b"),{name:"ImageList",props:{isShowAdd:{type:Boolean,default:!0},isShowAction:{type:Boolean,default:!0}},data:function(){var t=JSON.parse(window.localStorage.getItem("user"));return{collect:!1,images:[],dialogTableVisible:!1,uploadHeaders:{Authorization:"Bearer ".concat(t.token)},totalAll:0,totalCount:0,pageSize:10,page:1,loading:!0,selected:null}},created:function(){this.loadImages(1)},methods:{loadImages:function(t){var e=this;this.loading=!0,this.page=t,mt({collect:this.collect,page:t,per_page:this.pageSize}).then((function(t){e.loading=!1;var a=t.data.data,s=a.total_count,i=a.results;i.forEach((function(t){t.loading=!1})),e.images=i,e.totalCount=s,!1===e.collect&&(e.totalAll=s)}))},onUploadImgSuccess:function(){this.$notify({title:"成功",message:"图片上传成功",type:"success"}),this.dialogTableVisible=!1,this.loadImages(!1)},onUploadImgErr:function(){this.$notify({title:"错误",message:"图片上传失败",type:"error"})},onPageChange:function(t){this.loadImages(t)},onCollect:function(t){var e=this;t.loading=!0,ft(t.id,!t.is_collected).then((function(a){t.is_collected=!t.is_collected,t.loading=!1,e.$notify({title:"成功",message:t.is_collected?"收藏成功":"已取消收藏",type:"success"})})).catch((function(){t.loading=!1,e.$notify({title:"错误",message:"收藏失败",type:"error"})}))},onDelete:function(t){var e=this;t.loading=!0,vt(t.id).then((function(a){t.loading=!1,e.loadImages(e.page),e.$notify({title:"成功",message:"素材删除成功",type:"success"})})).catch((function(){t.loading=!1,e.$message({type:"error",message:"删除失败"}),e.$notify({title:"错误",message:"素材删除失败",type:"error"})}))}}}),yt=_t,xt=(a("0ef0"),Object(o["a"])(yt,Ct,wt,!1,null,"2f07cc04",null)),kt=xt.exports,$t={name:"UploadCover",props:["value"],data:function(){return{coverSelectDialog:!1,activeName:"first",previewImage:"",updateCoverLoading:!1}},components:{ImageList:kt},methods:{showCoverSelect:function(){this.coverSelectDialog=!0},onFileChange:function(){var t=this.$refs["upload-cover"],e=window.URL.createObjectURL(t.files[0]);this.previewImage=e},onUploadCover:function(){var t=this;if("second"===this.activeName){var e=this.$refs["upload-cover"].files[0];if(!e)return this.$notify({title:"提示",message:"请先选择文件",type:"warning"}),0;this.updateCoverLoading=!0;var a=new FormData;a.append("image",e),pt(a).then((function(e){t.$refs["cover-image"].src=e.data.data.url,t.updateCoverLoading=!1,t.coverSelectDialog=!1,t.$emit("input",e.data.data.url),t.$notify({title:"成功",message:"图片上传成功",type:"success"})})).catch((function(){t.updateCoverLoading=!1,t.$notify({title:"错误",message:"图片上传失败",type:"error"})}))}else if("first"===this.activeName){var s=this.$refs["image-list"],i=s.selected;if(null===i)return this.$notify({title:"提示",message:"请先选择封面",type:"warning"}),0;this.coverSelectDialog=!1,this.$emit("input",s.images[i].url)}},resetUploadImage:function(){this.previewImage=""}}},Ut=$t,St=(a("07f8"),Object(o["a"])(Ut,ht,bt,!1,null,"bfb9dffa",null)),zt=St.exports,Lt=(a("6236"),{name:"PublishIndex",data:function(){return{articleRules:{title:[{required:!0,message:"请输入文章标题",trigger:"blur"},{min:5,max:30,message:"长度在 5 到 30 个字符",trigger:"blur"}],content:[{required:!0,message:"请输入文章内容",trigger:"blur"},{validateContent:function(t,e,a){"<p></p>"===e?a(new Error("请输入文章内容")):a()}}],channel_id:[{required:!0,message:"请选择分类专栏"}]},user:{},article:{title:"",content:"",cover:{type:0,images:[]},channel_id:null},channels:[],extensions:[new gt["e"],new gt["B"],new gt["v"],new gt["l"]({level:6}),new gt["b"]({bubble:!0}),new gt["I"]({bubble:!0,menubar:!1}),new gt["q"]({bubble:!0}),new gt["w"]({bubble:!0}),new gt["t"],new gt["c"]({bubble:!0}),new gt["u"]({bubble:!0}),new gt["s"],new gt["o"]({uploadRequest:function(t){var e=new FormData;return e.append("image",t),pt(e).then((function(t){return t.data.data.url}))}}),new gt["d"]({bubble:!0}),new gt["a"],new gt["F"],new gt["G"],new gt["C"]({bubble:!0}),new gt["g"]({bubble:!0}),new gt["h"]({bubble:!0}),new gt["j"],new gt["E"]({bubble:!0}),new gt["D"]({bubble:!0}),new gt["i"]({bubble:!0}),new gt["x"]({resizable:!0}),new gt["z"],new gt["y"],new gt["A"],new gt["m"],new gt["H"],new gt["k"],new gt["n"],new gt["r"],new gt["p"]]}},created:function(){this.loadUserProfile(),this.loadChannels(),this.$route.query.id&&this.loadArticles()},methods:{loadUserProfile:function(){var t=this;k().then((function(e){t.user=e.data.data}))},loadChannels:function(){var t=this;P().then((function(e){t.channels=e.data.data.channels}))},onPublish:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$refs["publish-from"].validate((function(a){if(!a)return 0;if(t.$route.query.id){var s=t.$route.query.id;t.$confirm(e?"确认要保存为草稿吗？":"确认要修改文章吗？","修改",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){j(s,t.article,e).then((function(){t.$notify({title:"成功",message:e?"已存入草稿":"修改成功",type:"success"}),t.$router.push("/article")})).catch((function(){t.$notify({title:"错误",message:"修改失败",type:"error"})}))}))}else t.$confirm(e?"确认要保存为草稿吗？":"确认要发布文章吗？","发布",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){T(t.article,e).then((function(){t.$notify({title:"成功",message:e?"已存入草稿":"发布成功",type:"success"}),t.$router.push("/article")})).catch((function(){t.$notify({title:"错误",message:"发布失败",type:"error"})}))}))}))},loadArticles:function(){var t=this;F(this.$route.query.id).then((function(e){t.article=e.data.data}))},onUpdateCover:function(t,e){this.article.cover.images[t]=e}},components:{"el-tiptap":gt["f"],UploadCover:zt}}),At=Lt,Ot=(a("e745"),Object(o["a"])(At,ut,dt,!1,null,"a12b095c",null)),Et=Ot.exports,It=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"image-container"},[a("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[t._v("首页")]),a("el-breadcrumb-item",[t._v("素材")])],1)],1)]),a("div",[a("image-list")],1)])],1)},Pt=[],Dt={name:"ImageIndex",components:{ImageList:kt}},Tt=Dt,Ft=(a("a25d"),Object(o["a"])(Tt,It,Pt,!1,null,"30875558",null)),jt=Ft.exports,Vt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"comment-container"},[a("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[t._v("首页")]),a("el-breadcrumb-item",[t._v("评论管理")])],1)],1)]),a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],staticStyle:{width:"100%"},attrs:{data:t.articles}},[a("el-table-column",{attrs:{prop:"title",label:"标题"}}),a("el-table-column",{attrs:{prop:"total_comment_count",label:"总评论数"}}),a("el-table-column",{attrs:{prop:"fans_comment_count",label:"粉丝评论数"}}),a("el-table-column",{attrs:{label:"评论状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{size:"small",type:e.row.comment_status?"success":"danger"}},[t._v(t._s(e.row.comment_status?"已开启":"已关闭"))])]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-switch",{attrs:{"active-color":"#409eff","inactive-color":"#dcdfe6",disabled:e.row.isDisabled},on:{change:function(a){return t.onStatusChange(e.row)}},model:{value:e.row.comment_status,callback:function(a){t.$set(e.row,"comment_status",a)},expression:"scope.row.comment_status"}})]}}])})],1)],1),a("el-pagination",{staticClass:"list-pagination",attrs:{background:"","current-page":t.currentPage,"page-sizes":[10,20,30,40],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.totalCount,disabled:t.isLoading},on:{"size-change":t.onSizeChange,"current-change":t.onCurrentChange,"update:pageSize":function(e){t.pageSize=e},"update:page-size":function(e){t.pageSize=e}}})],1)],1)},Nt=[],Rt={name:"CommentIndex",data:function(){return{articles:[],totalCount:0,pageSize:10,currentPage:1,isLoading:!1}},created:function(){this.loadArticles()},methods:{loadArticles:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.isLoading=!0,this.currentPage=e,I({response_type:"comment",page:e,per_page:this.pageSize}).then((function(e){t.isLoading=!1;var a=e.data.data,s=a.results,i=a.total_count;s.forEach((function(t){t.isDisabled=!1})),t.articles=s,t.totalCount=i}))},onStatusChange:function(t){var e=this;t.isDisabled=!0,V(t.id.toString(),t.comment_status).then((function(a){t.isDisabled=!1,e.$notify({title:"成功",message:t.comment_status?"已开启评论":"已关闭评论",type:"success"})}))},onSizeChange:function(t){this.pageSize=t,this.loadArticles(1)},onCurrentChange:function(t){this.currentPage=t,this.loadArticles(this.currentPage)}}},qt=Rt,Mt=(a("a647"),Object(o["a"])(qt,Vt,Nt,!1,null,"0398e115",null)),Bt=Mt.exports,Ht=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"settings-container"},[a("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[t._v("首页")]),a("el-breadcrumb-item",[t._v("个人中心")])],1)],1)]),a("div",[a("el-tabs",{attrs:{activeName:"first"}},[a("el-tab-pane",{staticClass:"user-warp",attrs:{label:"账号详情",name:"first"}},[a("div",{staticClass:"user user-id"},[a("span",{staticClass:"user-warp-title"},[t._v("ID")]),a("span",{staticClass:"user-warp-content"},[a("span",[t._v(t._s(t.user.id))])])]),a("div",{staticClass:"user user-phone"},[a("span",{staticClass:"user-warp-title"},[t._v("手机号")]),a("span",{staticClass:"user-warp-content"},[a("span",[t._v(t._s(t.user.mobile))])])]),a("div",{staticClass:"user user-name"},[a("span",{staticClass:"user-warp-title"},[t._v("用户名")]),a("span",{staticClass:"user-warp-content"},[a("span",[t._v(t._s(t.user.name?t.user.name:"暂未设置用户名"))]),a("span",{staticClass:"tool-warp",on:{click:function(e){t.dialogUserNameVisible=!0}}},[t._v("编辑")])])]),a("div",{staticClass:"user user-desc"},[a("span",{staticClass:"user-warp-title"},[t._v("用户简介")]),a("span",{staticClass:"user-warp-content"},[a("span",[t._v(t._s(t.user.intro?t.user.intro:"填写简介更容易获得大家的关注哦"))]),a("span",{staticClass:"tool-warp",on:{click:function(e){t.dialogUserDescVisible=!0}}},[t._v("编辑")])])]),a("div",{staticClass:"user user-avator"},[a("span",{staticClass:"user-warp-title"},[t._v("用户头像")]),a("span",{staticClass:"user-warp-content"},[a("div",{staticClass:"avator-content"},[a("img",{attrs:{src:t.user.photo?t.user.photo:"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png",alt:""},on:{click:function(e){return t.$refs.uploadAvator.click()}}}),a("div",{staticClass:"add-avator",on:{click:function(e){return t.$refs.uploadAvator.click()}}},[t._v(t._s(t.user.photo?"更换头像":"上传头像"))])]),a("input",{ref:"uploadAvator",attrs:{type:"file",hidden:""},on:{change:t.onFileChange}})])]),a("div",{staticClass:"user user-email"},[a("span",{staticClass:"user-warp-title"},[t._v("邮箱")]),a("span",{staticClass:"user-warp-content"},[a("span",[t._v(t._s(t.user.email?t.user.email:"暂未绑定邮箱"))]),a("span",{staticClass:"tool-warp",on:{click:function(e){t.dialogUserEmailVisible=!0}}},[t._v(t._s(t.user.email?"更换邮箱":"绑定邮箱"))])])])])],1)],1)]),a("el-dialog",{staticClass:"dirlogs",attrs:{title:"编辑用户名",visible:t.dialogUserNameVisible,"append-to-body":!0,width:"450px","destroy-on-close":!0},on:{"update:visible":function(e){t.dialogUserNameVisible=e},closed:t.resetForm}},[a("el-form",{ref:"form",attrs:{model:t.previewUser,size:"medium",rules:t.rules}},[a("el-form-item",{attrs:{prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入用户名",maxlength:"7","show-word-limit":""},model:{value:t.previewUser.name,callback:function(e){t.$set(t.previewUser,"name",e)},expression:"previewUser.name"}}),a("p",[t._v("请勿使用包含特殊符号或含有明显营销推广意图的用户名")])],1)],1),a("div",{staticClass:"btns"},[a("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogUserNameVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.onUpdateUser(1)}}},[t._v("保 存")])],1)],1),a("el-dialog",{staticClass:"dirlogs user-desc-dirlog",attrs:{title:"编辑用户简介",visible:t.dialogUserDescVisible,"append-to-body":!0,width:"450px"},on:{"update:visible":function(e){t.dialogUserDescVisible=e},closed:t.resetForm}},[a("el-form",{ref:"form",attrs:{model:t.previewUser,size:"medium"}},[a("el-form-item",[a("el-input",{attrs:{type:"textarea",placeholder:"添加简介，让大家更好的认识你",maxlength:"70","show-word-limit":""},model:{value:t.previewUser.intro,callback:function(e){t.$set(t.previewUser,"intro",e)},expression:"previewUser.intro"}}),a("p",[t._v("要求内容完整通顺，无特殊符号")])],1)],1),a("div",{staticClass:"btns"},[a("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogUserDescVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.onUpdateUser(2)}}},[t._v("保 存")])],1)],1),a("el-dialog",{staticClass:"dirlogs user-desc-dirlog",attrs:{title:"更换头像",visible:t.dialogUserAvatorVisible,"append-to-body":!0,width:"500px"},on:{"update:visible":function(e){t.dialogUserAvatorVisible=e},opened:t.onAvatarDialogOpened}},[a("div",{staticClass:"avator-preview"},[a("img",{ref:"preview-image",attrs:{src:t.previewImage,alt:""}})]),a("div",{staticClass:"btns"},[a("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogUserAvatorVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"small",loading:t.updateAvatarLoading},on:{click:t.onUpdateAvatar}},[t._v("保 存")])],1)]),a("el-dialog",{staticClass:"dirlogs user-desc-dirlog",attrs:{title:"绑定邮箱",visible:t.dialogUserEmailVisible,"append-to-body":!0,width:"450px"},on:{"update:visible":function(e){t.dialogUserEmailVisible=e},closed:t.resetForm}},[a("el-form",{ref:"form",attrs:{model:t.previewUser,rules:t.rules,size:"medium"}},[a("el-form-item",{attrs:{prop:"email"}},[a("el-input",{attrs:{placeholder:"请输入邮箱"},model:{value:t.previewUser.email,callback:function(e){t.$set(t.previewUser,"email",e)},expression:"previewUser.email"}})],1)],1),a("div",{staticClass:"btns"},[a("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogUserEmailVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.onUpdateUser(3)}}},[t._v("保 存")])],1)],1)],1)},Gt=[],Jt=(a("ac1f"),a("5319"),a("6107"),a("bab4")),Wt=a.n(Jt),Kt={name:"SettingsIndex",data:function(){return{dialogUserNameVisible:!1,dialogUserDescVisible:!1,dialogUserAvatorVisible:!1,dialogUserEmailVisible:!1,updateAvatarLoading:!1,updateUsernameLoading:!1,updateIntroLoading:!1,updateEmailLoading:!1,user:{id:null,mobile:"",name:"",intro:"",photo:"",email:""},previewUser:{name:"",intro:"",email:""},previewImage:"",rules:{name:[{required:!0,message:"用户名不能为空",trigger:"blur"},{min:1,max:7,message:"长度在 1 到 7 个字符",trigger:"blur"}],email:[{type:"email",message:"请输入正确的邮箱",trigger:"blur"}]},cropper:null}},created:function(){this.loadUser()},methods:{loadUser:function(){var t=this;k().then((function(e){t.user=e.data.data;var a=t.user,s=a.name,i=a.intro,n=a.email;t.previewUser.name=s,t.previewUser.intro=i,t.previewUser.email=n}))},onFileChange:function(){var t=this.$refs.uploadAvator,e=window.URL.createObjectURL(t.files[0]);this.previewImage=e,t.value="",this.dialogUserAvatorVisible=!0},onAvatarDialogOpened:function(){if(this.cropper)this.cropper.replace(this.previewImage);else{var t=this.$refs["preview-image"];this.cropper=new Wt.a(t,{aspectRatio:1,viewMode:1,background:!1})}},onUpdateAvatar:function(){var t=this;this.updateAvatarLoading=!0,this.cropper.getCroppedCanvas().toBlob((function(e){var a=new FormData;a.append("photo",e),U(a).then((function(a){t.updateAvatarLoading=!1,t.dialogUserAvatorVisible=!1,t.user.photo=window.URL.createObjectURL(e),Z.$emit("update-user",t.user),t.$notify({title:"成功",message:"头像修改成功",type:"success"})})).catch((function(){t.updateAvatarLoading=!1,t.$notify({title:"错误",message:"头像修改失败",type:"error"})}))}))},onUpdateUser:function(t){var e=this,a=this.previewUser,s=a.name,i=a.intro,n=a.email;1===t?(this.updateUsernameLoading=!0,$({name:s}).then((function(t){e.updateUsernameLoading=!1,e.dialogUserNameVisible=!1,e.user.name=s,Z.$emit("update-user",e.user),e.$notify({title:"成功",message:"用户名修改成功",type:"success"})})).catch((function(){e.updateUsernameLoading=!1,e.$notify({title:"错误",message:"用户名修改失败",type:"error"})}))):2===t?(this.updateIntroLoading=!0,$({intro:i}).then((function(){e.updateIntroLoading=!1,e.dialogUserDescVisible=!1,e.user.intro=i,e.$notify({title:"成功",message:"用户简介修改成功",type:"success"})})).catch((function(){e.updateIntroLoading=!1,e.$notify({title:"错误",message:"用户简介修改失败",type:"error"})}))):3===t&&(this.updateEmailLoading=!0,$({email:n}).then((function(){e.updateEmailLoading=!1,e.dialogUserEmailVisible=!1,e.user.email=n,e.$notify({title:"成功",message:"邮箱绑定成功",type:"success"})})).catch((function(){e.updateEmailLoading=!1,e.$notify({title:"成功",message:"邮箱绑定失败",type:"error"})})))},resetForm:function(){var t=this.user,e=t.name,a=t.intro,s=t.email;this.previewUser.name=e,this.previewUser.intro=a,this.previewUser.email=s}}},Qt=Kt,Xt=(a("017c"),Object(o["a"])(Qt,Ht,Gt,!1,null,"434afa6c",null)),Yt=Xt.exports,Zt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"fans-container"},[a("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[t._v("首页")]),a("el-breadcrumb-item",[t._v("粉丝管理")])],1)],1)]),a("div",[a("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"数据",name:"first"}},[a("fans-data")],1),a("el-tab-pane",{staticClass:"fans-data-warp",attrs:{label:"粉丝列表",name:"second"}},[a("fans-list",{on:{"total-fans":t.getTotalFans}})],1)],1)],1)])],1)},te=[],ee=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"fans-list-container"},[0===t.totalFans?a("el-empty",{staticClass:"no-fans",attrs:{description:"暂无粉丝"}}):t._e(),a("el-row",{attrs:{gutter:20}},t._l(t.fansList,(function(e){return a("el-col",{key:e.id,attrs:{xs:12,sm:8,md:6,lg:4,xl:3}},[a("div",{staticClass:"grid-content bg-purple"},[a("div",{staticClass:"fans-item"},[a("div",{staticClass:"fans-avatar"},[a("img",{attrs:{src:e.photo?e.photo:"https://cube.elemecdn.com/9/c2/f0ee8a3c7c9638a54940382568c9dpng.png",alt:""}})]),a("div",{staticClass:"fans-name"},[t._v(t._s(e.name))]),a("div",{staticClass:"fans-follow-btn"},[a("el-button",{attrs:{type:"primary",size:"mini"}},[t._v("+关注")])],1)])])])})),1),a("el-pagination",{staticClass:"list-pagination",attrs:{background:"",layout:"prev, pager, next",total:t.totalFans,"hide-on-single-page":!0,"page-size":t.pageSize,"current-page":t.currentPage},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"current-change":t.onPageChange}})],1)},ae=[],se={name:"FansList",data:function(){return{fansList:{},totalFans:0,pageSize:10,currentPage:1}},created:function(){this.loadFansList()},methods:{loadFansList:function(){var t=this;N({page:this.currentPage,per_page:this.pageSize}).then((function(e){var a=e.data.data,s=a.results,i=a.total_count;t.fansList=s,t.totalFans=i,t.$emit("total-fans",t.totalFans)}))},onPageChange:function(){this.loadFansList(this.currentPage)}}},ie=se,ne=(a("d3ed"),Object(o["a"])(ie,ee,ae,!1,null,"4c985fa2",null)),re=ne.exports,le=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"fans-data-container"},[a("div",{staticClass:"fans-data-warp"},[a("div",{staticClass:"data-name"},[t._v("核心数据")]),a("div",{staticClass:"fans-core-data"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{xs:24,sm:8,md:6,lg:6,xl:6}},[a("div",{staticClass:"grid-content bg-purple"},[a("div",{staticClass:"core-data-item"},[a("div",{staticClass:"data-name"},[t._v("昨日粉丝变化数")]),a("div",{staticClass:"data-num"},[t._v("0")])])])]),a("el-col",{attrs:{xs:24,sm:8,md:6,lg:6,xl:6}},[a("div",{staticClass:"grid-content bg-purple"},[a("div",{staticClass:"core-data-item"},[a("div",{staticClass:"data-name"},[t._v("昨日粉丝活跃数")]),a("div",{staticClass:"data-num"},[t._v("0")])])])]),a("el-col",{attrs:{xs:24,sm:8,md:6,lg:6,xl:6}},[a("div",{staticClass:"grid-content bg-purple"},[a("div",{staticClass:"core-data-item"},[a("div",{staticClass:"data-name"},[t._v("昨日粉丝活跃占比")]),a("div",{staticClass:"data-num"},[t._v("0.00%")])])])]),a("el-col",{attrs:{xs:24,sm:8,md:6,lg:6,xl:6}},[a("div",{staticClass:"grid-content bg-purple"},[a("div",{staticClass:"core-data-item"},[a("div",{staticClass:"data-name"},[t._v("粉丝总数")]),a("div",{staticClass:"data-num"},[t._v(t._s(t.totalFans))])])])])],1)],1)]),a("div",{staticClass:"fans-data-warp"},[a("div",{staticClass:"data-name"},[t._v("数据趋势")]),a("div",{staticClass:"trend-data"},[a("trend-chart")],1)]),a("div",{staticClass:"fans-data-warp"},[a("div",{staticClass:"data-name"},[t._v("粉丝特征")]),a("div",{staticClass:"features-data"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{xs:24,sm:24,md:8,lg:8,xl:10}},[a("div",{staticClass:"features-data-item"},[a("sex-chart")],1)]),a("el-col",{attrs:{xs:24,sm:24,md:16,lg:16,xl:14}},[a("div",{staticClass:"features-data-item"},[a("age-chart")],1)])],1)],1)])])},oe=[],ce=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"trend-chart-container"},[a("div",{ref:"main",staticClass:"main"})])},ue=[],de=a("313e"),pe={name:"TrendChart",data:function(){return{}},mounted:function(){var t=de["a"](this.$refs.main),e={grid:{left:"2%",right:"2%",bottom:"2%",containLabel:!0},xAxis:{type:"category",data:["11/19","11/20","11/21","11/22","11/22","11/23","11/24"]},yAxis:{type:"value"},series:[{data:[150,230,224,218,135,147,260],type:"line"}]};t.setOption(e),window.addEventListener("resize",(function(){t.resize()}))}},me=pe,fe=(a("fd26"),Object(o["a"])(me,ce,ue,!1,null,"3dc25cb6",null)),ve=fe.exports,ge=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"sex-chart-container"},[a("div",{ref:"main",staticClass:"main"})])},he=[],be={name:"SexChart",data:function(){return{}},mounted:function(){var t=de["a"](this.$refs.main),e={title:{text:"性别分布",textStyle:{color:"#000",fontStyle:"normal",fontWeight:"normal",fontFamily:"Microsoft yahei",fontSize:14,align:"center"}},grid:{left:"2%",right:"2%",bottom:"2%",containLabel:!0},tooltip:{trigger:"item"},legend:{bottom:"5%",left:"center"},series:[{type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:8,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"20"}},labelLine:{show:!1},data:[{value:0,name:"男性"},{value:0,name:"女性"},{value:0,name:"未知性别"}]}]};t.setOption(e),window.addEventListener("resize",(function(){t.resize()}))}},Ce=be,we=(a("0d3c"),Object(o["a"])(Ce,ge,he,!1,null,"db3af57e",null)),_e=we.exports,ye=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"age-chart-container"},[a("div",{ref:"main",staticClass:"main"})])},xe=[],ke={name:"AgeChart",data:function(){return{}},mounted:function(){var t=de["a"](this.$refs.main),e={title:{text:"年龄分布",textStyle:{color:"#000",fontStyle:"normal",fontWeight:"normal",fontFamily:"Microsoft yahei",fontSize:14,align:"center"}},grid:{left:"2%",right:"2%",bottom:"2%",containLabel:!0},xAxis:{type:"category",data:["0-10","10-20","20-30","30-40","40-50","50-60","60+"]},yAxis:{type:"value"},series:[{data:[120,200,150,80,70,110,130],type:"bar",barWidth:30}]};t.setOption(e),window.addEventListener("resize",(function(){t.resize()}))}},$e=ke,Ue=(a("6721"),Object(o["a"])($e,ye,xe,!1,null,"15f5907e",null)),Se=Ue.exports,ze={name:"FansData",data:function(){return{totalFans:0}},created:function(){this.loadFans()},methods:{loadFans:function(){var t=this;N({}).then((function(e){var a=e.data.data.total_count;t.totalFans=a}))}},components:{TrendChart:ve,SexChart:_e,AgeChart:Se}},Le=ze,Ae=(a("e126"),Object(o["a"])(Le,le,oe,!1,null,"20582b16",null)),Oe=Ae.exports,Ee={name:"FansIndex",data:function(){return{activeName:"first",totalFans:0}},methods:{getTotalFans:function(t){this.totalFans=t}},components:{FansList:re,FansData:Oe}},Ie=Ee,Pe=(a("2820"),Object(o["a"])(Ie,Zt,te,!1,null,"8cf9ca7c",null)),De=Pe.exports;s["default"].use(d["a"]);var Te=[{path:"/login",name:"login",component:A},{path:"/",component:st,children:[{path:"",name:"home",component:B},{path:"/article",name:"article",component:ct},{path:"/publish",name:"publish",component:Et},{path:"/image",name:"image",component:jt},{path:"/comment",name:"comment",component:Bt},{path:"/settings",name:"settings",component:Yt},{path:"/fans",name:"fans",component:De}]}],Fe=new d["a"]({routes:Te});Fe.beforeEach((function(t,e,a){if("/login"!==t.path){var s=localStorage.getItem("user");s?a():a("/login")}else a()}));var je=Fe,Ve=a("2f62");s["default"].use(Ve["a"]);var Ne=new Ve["a"].Store({state:{},mutations:{},actions:{},modules:{}});a("0fae"),a("7eef"),a("a4b1");s["default"].use(w.a),s["default"].config.productionTip=!1,new s["default"]({router:je,store:Ne,render:function(t){return t(u)}}).$mount("#app")},"5ef3":function(t,e,a){},"5f3a":function(t,e,a){},6236:function(t,e,a){},6465:function(t,e,a){},6721:function(t,e,a){"use strict";a("be98")},7965:function(t,e,a){},8177:function(t,e,a){},"8d14":function(t,e,a){},a25d:function(t,e,a){"use strict";a("6465")},a3f4:function(t,e,a){"use strict";a("e8ab")},a4b1:function(t,e,a){},a5fa:function(t,e,a){},a647:function(t,e,a){"use strict";a("a5fa")},afaa:function(t,e,a){"use strict";a("c0d9")},afb6:function(t,e,a){"use strict";a("3991")},be98:function(t,e,a){},c0d9:function(t,e,a){},cf05:function(t,e,a){t.exports=a.p+"img/logo.d8f2f63f.png"},d3ed:function(t,e,a){"use strict";a("5ef3")},e126:function(t,e,a){"use strict";a("8177")},e745:function(t,e,a){"use strict";a("2c89")},e8ab:function(t,e,a){},f2eb:function(t,e,a){},f53a:function(t,e,a){},fd26:function(t,e,a){"use strict";a("f2eb")}});
//# sourceMappingURL=app.72c9034f.js.map